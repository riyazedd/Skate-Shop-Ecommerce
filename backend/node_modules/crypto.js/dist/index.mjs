import I from"os";import b from"fs";import n from"crypto";var a=["aes-128-gcm","aes-192-gcm","aes-256-gcm","aes-128-ccm","aes-192-ccm","aes-256-ccm","aes-128-ocb","aes-192-ocb","aes-256-ocb"],x=+process.versions.node.split(".").slice(0,2).join("."),l=Buffer.alloc(16);function h(e,r){return r===void 0||r==="buffer"?e:e.toString(r)}n.randomUUID||(n.randomUUID=function(){let e=n.randomBytes(16).toString("hex");return e.slice(0,8)+"-"+e.slice(8,12)+"-"+e.slice(12,16)+"-"+e.slice(16,20)+"-"+e.slice(-12)});n.randomInt||(n.randomInt=function(e){if(e===void 0)throw new TypeError('[ERR_INVALID_ARG_TYPE]: The "max" argument must be a safe integer. Received undefined');return~~(Math.random()*e)});var p=function(e,r,f){let t=n.createHash(e),u=Buffer.isBuffer(r);return t.update(r,u?"buffer":"utf8"),t.digest(f||"hex")},_=function(e,r,f,t){f=f||"";let u=n.createHmac(e,f),o=Buffer.isBuffer(r);return u.update(r,o?"buffer":"utf8"),u.digest(t||"hex")},S=function(e,r,f=l,t="utf8",u){if(x>=10.5)return m(e,r,f,l,t,u);t=Buffer.isBuffer(r)?"buffer":t;let s=n.createCipher(e,f),i=s.update(r,t);return i=Buffer.concat([i,s.final()]),a.indexOf(e)>-1&&(i=Buffer.concat([i,s.getAuthTag()])),h(i,u)},y=function(e,r,f=l,t="base64",u="utf8"){if(x>=10.5)return g(e,r,f,l,t,u);Buffer.isBuffer(r)||(r=Buffer.from(r,t)),t="buffer";let s=n.createDecipher(e,f);if(a.indexOf(e)>-1){let c=r.slice(-16);r=r.slice(0,-16),s.setAuthTag(c)}let i=s.update(r,t);return i=Buffer.concat([i,s.final()]),h(i,u)},m=function(e,r,f=l,t=l,u="utf8",o){u=Buffer.isBuffer(r)?"buffer":u;let i=n.createCipheriv(e,f,t),c=i.update(r,u);return c=Buffer.concat([c,i.final()]),a.indexOf(e)>-1&&(c=Buffer.concat([c,i.getAuthTag()])),h(c,o)},g=function(e,r,f=l,t=l,u="base64",o="utf8"){Buffer.isBuffer(r)||(r=Buffer.from(r,u)),u="buffer";let i=n.createDecipheriv(e,f,t);if(a.indexOf(e)>-1){let v=r.slice(-16);r=r.slice(0,-16),i.setAuthTag(v)}let c=i.update(r,u);return c=Buffer.concat([c,i.final()]),h(c,o)};var A=function(e){for(let r in e){if(r==="lo")continue;return e[r].pop().mac.replace(/:/g,"").slice(-4)}return Math.random().toString(16).slice(-4)}(I.networkInterfaces()),B=4096;function d(e,r){let f,t;return Buffer.isBuffer(e)?f=e:f=Buffer.from(e+""),t=f.toString("base64"),r?t.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,""):t}function D(e,r){return r&&(e=e.replace(/-/g,"+").replace(/_/g,"/").replace(/[^A-Za-z0-9\+\/]/g,"")),Buffer.from(e,"base64")}function T(e,r){let f="qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM0123456789";r&&(f="0123456789");let t=f.length,u="";for(let o=0;o<e;o++)u+=f[n.randomInt(t)];return u}function U(e="-"){let r=n.randomUUID(),f=(~~(Date.now()/1e3)).toString(16);return B>65535&&(B=4096),r=B.toString(16)+r,B++,f+e+A+e+r.slice(0,4)+e+r.slice(-8)}function O(e,r){return typeof e=="number"&&(e+=""),typeof e=="string"||Buffer.isBuffer(e)?p("md5",e,r):e}function w(e){try{let r=b.readFileSync(e);return p("md5",r)}catch{return null}}function R(e,r){return typeof e=="number"&&(e+=""),typeof e=="string"||Buffer.isBuffer(e)?p("sha1",e,r):e}function M(e){try{let r=b.readFileSync(e);return p("sha1",r)}catch{return null}}function C(e,r){return typeof e=="number"&&(e+=""),typeof e=="string"||Buffer.isBuffer(e)?p("sha256",e,r):e}function F(e){try{let r=b.readFileSync(e);return p("sha256",r)}catch{return null}}var z={base64encode:d,base64decode:D,rand:T,uuid:U,md5:O,md5Sign:w,sha1:R,sha1Sign:M,sha256:C,sha256Sign:F,crypto:n,origin:n,hash:p,hmac:_,cipher:S,decipher:y,cipheriv:m,decipheriv:g};export{D as base64decode,d as base64encode,S as cipher,m as cipheriv,n as crypto,y as decipher,g as decipheriv,z as default,p as hash,_ as hmac,O as md5,w as md5Sign,n as origin,T as rand,R as sha1,M as sha1Sign,C as sha256,F as sha256Sign,U as uuid};
